---
layout: post
title: 'Tumbling, Part Three: Stochastic Spread'
date: '2011-06-28T18:04:00.000-07:00'
author: Oatzy
tags:
- graph
- programming
- nerd
- python
- infographic
- flowchart
- maths
- modelling
- network
- tumblr
modified_time: '2011-06-29T13:20:06.827-07:00'
thumbnail: http://1.bp.blogspot.com/-T6ckl3GM94M/TgpGWhmVyzI/AAAAAAAAAhk/qPfYj_nQSuU/s72-c/tumblr-flowchart.png
blogger_id: tag:blogger.com,1999:blog-14769935.post-6201995145195025086
blogger_orig_url: https://oatzy.blogspot.com/2011/06/tumbling-part-three-stochastic-spread.html
---

<b>No SIR</b><br /><br />So having written the <a href="http://oatzy.blogspot.com/2011/06/tumbling-part-one-some-background.html">previous</a> <a href="http://oatzy.blogspot.com/2011/06/tumbling-part-two-over-threshold.html">posts</a>, I was wondering if this spread could be modeled. We could use the <a href="http://en.wikipedia.org/wiki/Epidemic_model#The_SIR_Model">SIR equations</a>, but this runs into the problems I mentioned <a href="http://oatzy.blogspot.com/2010/09/social-viruses.html">before</a> - i.e. it assumes regular infection rate, approximately uniform population distribution, etc - and as the graphs showed, this is not the case with Tumblr (or Twitter, for that matter).<br /><br />There are, in fact, <a href="http://en.wikipedia.org/wiki/Epidemic_models_on_lattices">modifications</a> to the SIR model to make it work with irregular population distributions. But I'm not entirely familiar with these, so I'm kinda going my own way with it and hoping for the best.<br /><br />I should point out that, while SIR models are typically time linked, in this case we're working in '<i>spread over eccentricity</i>' (as discussed in <a href="http://oatzy.blogspot.com/2011/06/tumbling-part-one-some-background.html">Part 1</a>). The effect of this is that the model won't reflect real-time spread, but rather how wide and far from the source it goes.<br /><br /><br /><b>Scattered Clusters</b><br /><br />The majority of users will have between ~100-200  followers. The numbers of 'leaders' then decreases exponentially as the follower counts get bigger - with very few users having follower numbers in  the thousands. Or so I'm choosing to assume; I have no data to support this.<br /><br />So for this model, the users' follower counts are generated randomly using a <a href="http://en.wikipedia.org/wiki/Log-normal_distribution">log-normal distribution</a>.&nbsp; This seems like the most  plausible fit for the real-world.<br /><br /><br />For the implementation of the model, all users are generated prior to the actual spread simulation - creating a '<i>user pool</i>' of the entire population (size N). Users are then randomly select from this pool as and when needed.<br /><br />Pre-generating the users creates consistency, and makes it easier to keep track of who has already seen the post - assigning a new property to each user, <i>user.exposed</i>, which equals 1 if they have seen the post, and 0 otherwise.<br /><br /><br /><b>Model Mechanics</b><br /><br />You can download the code for the completed model <a href="http://dl.dropbox.com/u/4635169/tumblr.model.py">here</a> (Python) <b><br /></b><br /><br />So the basics of the model work like this:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-T6ckl3GM94M/TgpGWhmVyzI/AAAAAAAAAhk/qPfYj_nQSuU/s1600/tumblr-flowchart.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="322" src="http://1.bp.blogspot.com/-T6ckl3GM94M/TgpGWhmVyzI/AAAAAAAAAhk/qPfYj_nQSuU/s400/tumblr-flowchart.png" width="400" /></a></div>Starting with the original poster (OP), who has <i>F = f0</i> followers:<br /><br />a) <i>Select F users at random from the 'user pool'</i><br /><br />Then, for each user:<br /><br />i) <i>Has that user already seen the post?</i><br /><br />If no,<br /><br />ii) <i>How does the user react to the post?</i><br /><br /><i>Ignore</i>, <i>like</i>, <i>reblog</i>? Increment counters accordingly.<br /><br />This bit of code is essentially the same as that discussed in <a href="http://oatzy.blogspot.com/2011/06/tumbling-part-two-over-threshold.html">Part 2</a> - using the '<i>per-person</i>' approach. We also introduce a new counter, <i>eReblog</i>, which keeps track of the (cumulative) number of reblogs at each level of eccentricity.<br /><br />iii) <i>If a user reblogs, add </i><i>their follower count</i><i> to the 'follower counter' (fi) </i><br /><br />This is something of a corner-cutting method - the follower counts for all reblogging users are mixed into the same counter. Since some of the follower groups might overlap, users are selected from the pool <i>with replacement </i>to compensate<i>.</i> <br /><br />This method is perfectly fine, so long as we don't want to create graphs of who reblogs who. And for simplicity, we don't.<br /><br />b) <i>If fi = 0, end simulation. Else, go back to (a) with F = fi</i><br /><br />Termination condition - obviously, if no-one reblogs the post, there's no need to go any further.<br /><br />That's basically it.<br /><br /><br /><b>Initial Conditions</b><br /><br />Population = <i>3,000</i>; F0 = <i>150</i>, Threshold Ranges: <i>[4,11]</i>, Post Quality: <i>No(3,2)</i>, Followers: <i>Log-No(5,2)</i><br /><br />Obviously, the population of Tumblr is much larger than <i>3,000</i>. But this code starts to struggle when you get into the <i>10,000s</i>, so if we're too impatient to wait much more than a minute for results, we have to make concessions . Not that that should have significant effect, other than the population being exhausted quicker.<br /><br />The post quality has been set low, and the thresholds high, so that the spread doesn't instantly explode and burn out. This makes the results more interesting to observe.<br /><br /><br /><b>Reassuring Results</b><br /><br />Below is a graph of seven example outputs of the model - ALL with the same initial conditions.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-6OV35yJ9SZA/TgpJYapSXWI/AAAAAAAAAho/MS7bNKEptwY/s1600/Tumblr-model-outcomes.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="204" src="http://4.bp.blogspot.com/-6OV35yJ9SZA/TgpJYapSXWI/AAAAAAAAAho/MS7bNKEptwY/s400/Tumblr-model-outcomes.png" width="400" /></a></div>Note the wide variation in behaviour. This is really the sort of thing I wanted to see. <br /><br />In particular, I like '<i>Row 8</i>' (dark purple) - the way it stays fairly low, then has a sudden burst at generation 4 - similar to what happened with the <i>Dr Who</i> image in <a href="http://oatzy.blogspot.com/2011/06/tumbling-part-one-some-background.html">Part 1</a> (albeit with only one burst).<br /><br />We also have, in '<i>Row 2</i>' (red) a spread that starts to die out immediately, as with the <i>HIMYM</i> image (also mentioned previously).<br /><br />One result not graphed, because it can't be, was an example outcome where the post didn't spread at all (ie 0 reblogs) - which is not an uncommon occurrence in the real world.<br /><br />While we're at it, here is graph for the average of all the lines in the previous image<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-PsZGkU_w2UM/TgpKgiTPkiI/AAAAAAAAAhs/-tyWmz2JIdw/s1600/Tumblr-model-outcomes-average.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="201" src="http://3.bp.blogspot.com/-PsZGkU_w2UM/TgpKgiTPkiI/AAAAAAAAAhs/-tyWmz2JIdw/s400/Tumblr-model-outcomes-average.png" width="400" /></a></div>I would guess, if you averaged many more sample outputs, the curve would even-out into a single hump. <br /><br />For comparison, here is what the graph looks like when the post quality is higher, and the approval threshold on a wider range<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-XEEaSYhreWU/TgpK380iyjI/AAAAAAAAAhw/m48zb1S87B0/s1600/Tumblr-model-fast.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="http://3.bp.blogspot.com/-XEEaSYhreWU/TgpK380iyjI/AAAAAAAAAhw/m48zb1S87B0/s400/Tumblr-model-fast.png" width="400" /></a></div>Basically, a lot of reblogs over a very short space of time. Which, as mentioned above, was why I set the initial conditions lower.<br /><br /><br />Shape-wise, these graphs don't seem to differ significantly from those you'd expect to see from a SIR model. Not identical - there's certainly much more variance from this model - but it's interesting to see all the same.<br /><br />Finally, if OP is '<a href="http://www.urbandictionary.com/define.php?term=tumblr+famous">Tumblr Famous</a>' - that is, has <i>1,000</i> or more followers - this model would seem to suggest that their larger follower count has little effect on how far a post (subject to our initial conditions) would spread. This seems strange.<br /><br />That being said, if we're using a population size = <i>3,000</i> , then an OP starting with <i>1,000</i> followers means that a third of the population is exposed and used up right away. So further investigation is probably needed on that one.<br /><br /><br /><b>Notes and Improvements</b><br /><br />So this model works, and is pretty good. But it's by no means perfect.<br /><br />1) The Problem With Approval<br /><br />Behaviour of super-node <i>may </i>vary from that of normal people - eg more exclusive, selective, etc - but for simplicity, this is ignored. That said, if true it wouldn't be too hard to have approval thresholds dependent on, for example, follower count.<br /><br />2) Reblogs From Tags<br /><br />Some people discover via their tags - or for that matter, through search engines - rather than from the people they follow. If we were desperate to incorporate this into the model, it could be as straight forward as picking extra (unexposed) users when choosing from the user pool.<br /><br />3) Didn't See It<br /><br />Some people just don't see the post, or don't see it til much later and from someone else. But we can assume that the former are indistinguishable from those who did and ignored, and can ignore the latter.<br /><br />4) Who Reblogged Who<br /><br />We'd have to replace the part of code where the reblogs are grouped into a single counter with code that has some sort awareness of who each user reblogged - see <a href="http://oatzy.blogspot.com/2011/06/tumbling-appendix-i-making-connections.html">Appendix I</a><br /><br />And while we're at it, we could also build up a graph off how all these users are connected - ie, a who follows who graph. But that's not necessary.<br /><br />5) Fine-Tuning<br /><br />For this model I chose the random distributions and variables arbitrarily, but based on  educated guessing. Obviously, this is not ideal. For the best model, we'd need to tweak these to closely match real-world data. Sadly, I don't know where this data would come from. <br /><br /><br /><b>What Use Is This Anyway?</b><br /><br />The thing is, the advantage of the SIR models is that they can be solved exactly when looking for <a href="http://en.wikipedia.org/wiki/Stationary_points">stationary points</a>, or what initial conditions would lead to an epidemic, etc. <br /><br />This is not the case with our <a href="http://en.wikipedia.org/wiki/Stochastic">stochastic</a> model. Instead, we're left having to just play with the variables and observe the resulting behaviour. We could also modify the code to allow predefined variables to remove some of the randomness.<br /><br />One other way the model could be used is, for a fixed set of initial conditions, repeat the simulation a significantly large number of times and look for the most likely outcome, as per the <a href="http://en.wikipedia.org/wiki/Monte_carlo_method">Monte Carlo method</a>.<br /><br />And as mentioned above, a similar model can be used to model spread of information through any network - including Twitter. It's just a matter of tweaking variables. <br /><br />Anyway, the model serves its purpose as is, and I'm pleased with it. So yeah.<br /><br /><br />Oatzy