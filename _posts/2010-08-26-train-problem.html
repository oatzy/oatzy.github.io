---
layout: post
title: The Train Problem
date: '2010-08-26T16:35:00.000-07:00'
author: Oatzy
tags:
- trains
- nerd
- everyday maths
- problem solving
- public transport
- maths
modified_time: '2010-08-26T16:42:47.817-07:00'
thumbnail: http://2.bp.blogspot.com/_p_IGrzjF6JY/THbr6q7zmSI/AAAAAAAAAL0/6rAEGoaEosE/s72-c/difference-eqn.png
blogger_id: tag:blogger.com,1999:blog-14769935.post-4093151854698036158
blogger_orig_url: https://oatzy.blogspot.com/2010/08/train-problem.html
---

It started with a simple question - will I get a seat on the train?<br /><br />While it may seem like a straight-forward question, since I thought of it, finding a solution has been the smoldering bane of my existence. I tried several approaches in the past, each with varying degrees of success. But the one I'm going to outline is the best I've managed - it makes no assumptions and is based on simple logic. But more on that shortly.<br /><br /><b>Approach</b><br /><br />Whether you'll get a seat depends on two things:<br /><br />1) the total number of seats on the train<br />2) the number of passengers on the train<br /><br />For <i>(1)</i>, the number of seats is countable (prior to boarding the train). So what you need to try and calculate/estimate is <i>(2)</i> how many people are on the train, and therefore, how many seats (if any) will be available.<br /><br /><br /><b>Modelling</b><br /><br />The number of people on a train when it leaves a station can be described as follows<br /><blockquote>Passengers = (passengers on-board when the train arrived) - (passengers who get off) + (passengers who get on)</blockquote><br />Or as a difference equation; at station i:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_p_IGrzjF6JY/THbr6q7zmSI/AAAAAAAAAL0/6rAEGoaEosE/s1600/difference-eqn.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/_p_IGrzjF6JY/THbr6q7zmSI/AAAAAAAAAL0/6rAEGoaEosE/s320/difference-eqn.png" /></a></div>where <i>N_i</i> is passengers on-board, <i>D_i</i> is passengers 'disembarking' and <i>B_i</i> is passengers boarding.<br /><br />But that's only useful if we know <i>N_{i-1}</i>, <i>D_i</i> and <i>B_i</i> - and to be fair, we can count the people on the platform for an estimate of B_i. But, how do we know, or work-out, the other two variables?<br /><br />Consider a simplified version* - a train that visits 4 stations (total):<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_p_IGrzjF6JY/THbsDU645OI/AAAAAAAAAL8/kSSsVJnV-Aw/s1600/train-diagram.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/_p_IGrzjF6JY/THbsDU645OI/AAAAAAAAAL8/kSSsVJnV-Aw/s320/train-diagram.jpg" /></a></div><br />So what the diagram shows is, we can think of the problem in terms of passengers traveling between any two given stations. Define a function <i>T(i, j)</i> as the number of passengers traveling from station <i>i</i> to station <i>j</i> (we'll look at <i>T</i> in more detail later).<br /><br />So for the example above,<br /><br />N_0 = passengers getting on at <i>0</i>; passengers traveling from <i>0</i> to <i>1</i>, <i>2</i> and <i>3</i> = T(0, 1) + T(0, 2) + T(0, 3)<br />N_1 = passengers already on minus getting off plus getting on = T(0, 2) + T(0, 3) + T(1, 2) + T(1, 3)<br />N_2 = T(0, 3) + T(1,3) + T(2, 3)<br />N_3 = 0&nbsp; [since everyone gets off at <i>3</i>]<i><br /></i><br /><br /><br />And from all that, we get that <i>B_i</i> and <i>D_i</i> can be written mathematically as<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_p_IGrzjF6JY/THbsewQ0ThI/AAAAAAAAAME/yW4fkVm4CJ4/s1600/B-D-Summations.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/_p_IGrzjF6JY/THbsewQ0ThI/AAAAAAAAAME/yW4fkVm4CJ4/s320/B-D-Summations.png" /></a></div>And all of this can be combined into one 'train equation'<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_p_IGrzjF6JY/THbs3gv-W3I/AAAAAAAAAMM/qdnlObXi1i0/s1600/Train-Eqn.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/_p_IGrzjF6JY/THbs3gv-W3I/AAAAAAAAAMM/qdnlObXi1i0/s320/Train-Eqn.png" /></a></div><br /><b>Usage</b><br /><br />So once you've solved that equation, your probability is simply<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_p_IGrzjF6JY/THbtD5myeCI/AAAAAAAAAMU/fSJijr0hat8/s1600/prob.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/_p_IGrzjF6JY/THbtD5myeCI/AAAAAAAAAMU/fSJijr0hat8/s320/prob.png" /></a></div><br />(Where S in total number of seats available.)<br /><br />And that's all well and good, and theoretically it works. But it's also useless if we can't define <i>T(i, j)</i>.<br /><br />So how do you define <i>T(i, j)</i>?<br /><br />First of all, logic says that it should be dependent on the popularity of the stations in question. For example, you'd expect more people to be going <i>Sheffield</i> to <i>Birmingham New Street</i> than <i>Derby</i> to <i>Birmingham International</i>.<br />[if you don't know what I'm on about, you'll just have to trust me.]<br /><br />And for this, we can work from something like <a href="http://www.guardian.co.uk/news/datablog/2009/jul/02/rail-transport-travelleisure">this</a> [a spreadsheet giving details on the use of every station in the UK]. The only downside is, I haven't figured out the best way to use this data yet.<br /><br />The other major thing to consider is temporal effects - you would expect, for example, higher use at rush-hours etc. Similarly, over the course of the year, you might expect higher usage, say, around Christmas. And if you've been on a train around Christmas, or at rush-hour, you'll be familiar with this horror.<br /><br />So the T-function might involve something to distort it into this sort of shape<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_p_IGrzjF6JY/THbtNimKzDI/AAAAAAAAAMc/N7R4wBruF94/s1600/rush-hour.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/_p_IGrzjF6JY/THbtNimKzDI/AAAAAAAAAMc/N7R4wBruF94/s320/rush-hour.png" /></a></div><br />But with, maybe, a less dramatic dip in the middle. That equation, in case you're interested is a variation on <i>Sin(x)[2Sin(x) +1]</i><br /><br /><i>Pro tip</i>: I have found that the best time to travel in the afternoon is around 3 o'clock. <br /><br />But realistically, these are the sort of things you'd have to measure 'experimentally'. And being a theoretical man, that's really not for me to bother with.<br /><br /><br /><b>Practical Advice</b><br /><br />Of course, all this assumes that you don't have a seat reserved. If you do, all this is null and void. But otherwise..<br /><br />The major caveat to this is that, due to the complexity of the system, this approach can't tell you exactly how many seats there will be. At best, it's a general estimate.<br /><br />In fact, in general, this approach is really impractical, and as a result nigh on useless. Instead, you're best bet is to take steps to actively improve your odds. Most of this is fairly obvious, but still..<br /><br />So for example:<br /><br />1) Stand at the far end of the platform (away from the crowds) to reduce your per carriage competition.<br />2) If you know which way the train is coming in, try to stand towards the back (for Virgin Trains). Carriage C/D is usually the completely unreserved one.<br />3) In the subtlest and calmest way possible, get to the front of any queue at your door of choice. <br /><i>Pro tip</i>: Stand side on to the train so you're facing into the carriage. There's a good reason for why that gets you on quicker, but I can't, for the life of me, remember where I read it. But I do know from experience that it works.<br />4) Once you're on, quickly assess how many free seats there are. If they seem limited, grab the first (unreserved) one you see. If there aren't any unreserved, just grab the first free seat you come to and pray no-one tries to claim it.<br />5) If all else fails, just remember - the cool kids sit on the floor (Y)<br /><br /><br /><br /><b>Conclusion</b><br /><br />Another thing to note is that this could ultimately be  applied to an form of public transport. But there's a certain added  complexity in buses (and some trams) since they won't necessarily visit  all stops on a route. But this can be approximated by making the  T-function for these stops zero.<br /><br />As will all my maths-y posts so far, this is really more of an intellectual exercise, that can't really be applied practically. But there you go.<br /><br />'Til next time,<br /><br /><br />Oatzy<br /><br /><br /><br />[*funny story, the inspiration for this approach actually came from Quantum Physics (quantised energy levels, etc).&nbsp; Yeah, I know. I'm a nerd.]