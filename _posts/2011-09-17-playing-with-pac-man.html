---
layout: post
title: Playing with Pac-Man
date: '2011-09-17T19:02:00.000-07:00'
author: Oatzy
tags:
- nerd
- games
- infographic
- over-thinking
- dreams
- pac-man
- graph
- graph theory
- problem solving
- hypothetical question
- maths
- network
modified_time: '2011-09-17T19:02:12.424-07:00'
thumbnail: http://2.bp.blogspot.com/-TRslj0ENuFA/TnVPVp0xn7I/AAAAAAAAAr4/EowMw1bV_2c/s72-c/pacman--graph.png
blogger_id: tag:blogger.com,1999:blog-14769935.post-3022113809302593808
blogger_orig_url: https://oatzy.blogspot.com/2011/09/playing-with-pac-man.html
---

<b>What the Puck?</b><br /><br />For those unfamiliar, <a href="http://en.wikipedia.org/wiki/Pacman">Pac-Man</a> is an old arcade game, where you play as a cheese pizza trying to collect pellets while being chased round a maze by four whimsically named ghosts. Although really, if you are unfamiliar with Pac-Man, there's something wrong with you. Anyway, you can have a play online <a href="http://www.thepcmanwebsite.com/media/pacman_flash/">here</a>.<br /><br />The four ghost are <i>Blinky</i>, <i>Pinky</i>, <i>Inky</i>, and <i>Clyde</i>. For a good explanation of the ghosts' behaviours, <a href="http://gameinternals.com/post/2072558330/understanding-pac-man-ghost-behavior">here</a>'s a post from the tragically short-lived '<a href="http://gameinternals.com/">Game Internals</a>' blog.<br /><br /><i>tl;dr</i> Blinky chases, Pinky ambushes, Inky teams up with Blinky, and Clyde does pretty much whatever the fuck he wants. But really, you should read the article.<br /><br />And as for the origin of the name, I'll let <a href="http://youtu.be/y6x4P6Afje4">Scott Pilgrim</a> explain. Or if you prefer to read, <a href="http://en.wikipedia.org/wiki/Pacman#Development">wikipedia</a>.<br /><br /><br /><b>Wakking Round in Circles</b><br /><br /><a href="http://en.wikipedia.org/wiki/Graph_theory">Graph Theory</a> is a fantastic area of maths. Graph Theory can find you the <a href="http://en.wikipedia.org/wiki/Shortest_path_problem">shortest route</a>, help you get out of a <a href="http://en.wikipedia.org/wiki/Maze_solving_algorithm">maze</a>, tells you how to <a href="http://en.wikipedia.org/wiki/Four-color_theorem">colour a map</a> so no adjoining regions are of the same colour, to <a href="http://www.pnas.org/content/98/17/9748.long">reconstruct</a> DNA fragments, and help you find the <a href="http://en.wikipedia.org/wiki/Traveling_salesman_problem">best route</a> for sight-seeing. Among many <a href="http://en.wikipedia.org/wiki/Graph_theory#Applications">other things</a>.<br /><br />But sadly graph theory tends to be covered more in Computer Science courses than Maths courses. So for myself, i have to be content with <a href="http://www.amazon.co.uk/Nets-Puzzles-Postmen-exploration-mathematical/dp/0199218439/ref=sr_1_1?ie=UTF8&amp;qid=1316307859&amp;sr=8-1">books</a> and the internet. Not that I let such thing hold me back.<br /><br /><br />So the question is this - <i>Find the optimal route around the Pac-Man maze</i><br /><br />What we want to do is find a route around the maze while collects every pellet. Or in graph theory terms, a route which travels along every edge at least once.<br /><br />First of all, we need to turn the maze into a network graph. For this, we place a node at each junction, and join pairs of nodes according to whether or not there is a direct route between the pair.<br /><br />So here's what the maze looks like, beside what the graph of that maze looks like.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-TRslj0ENuFA/TnVPVp0xn7I/AAAAAAAAAr4/EowMw1bV_2c/s1600/pacman--graph.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-TRslj0ENuFA/TnVPVp0xn7I/AAAAAAAAAr4/EowMw1bV_2c/s1600/pacman--graph.png" /></a></div>The blue edges are the ones with pellets. The red edges are the ones without pellets, which you don't necessarily have to visit.<br /><br />And we can assign to each edge a 'weight' - i.e. the distance (in grid squares) between the pairs of nodes<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-ywYFqjjm0o8/TnVPPymPyBI/AAAAAAAAAr0/6JjI0a7NRNA/s1600/pacman-weight-graph.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-ywYFqjjm0o8/TnVPPymPyBI/AAAAAAAAAr0/6JjI0a7NRNA/s1600/pacman-weight-graph.png" /></a></div>Now, first of all, we note that there are a lot of node where an odd number of edges meet (with odd degree). What this means is that the graph is not <a href="http://en.wikipedia.org/wiki/Eulerian_path">Eulerian</a> - what that means is, there doesn't exist a route around the graph which visits each edge <i>exactly</i> once.<br /><br />Which means that we will definitely have to travel along some paths more than once.<br /><br /><br />So the optimal path is going to be the one which minimises the total distance traveled. This is an example of the <a href="http://en.wikipedia.org/wiki/Chinese_postman">Chinese Postman Problem</a>, and fortunately, there is an algorithm for finding the shortest route.<br /><br />Without going into too much detail, what you do is pair up odd nodes, and find the shortest paths between them (using <a href="http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm">Dijkstra's Algorithm</a>). This makes the graph Eulerian, i.e. so that a route that visits each edge at least once exists. <br /><br />So if we take the bottom corner as an example, there are four node of odd degree (green).<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-WOD5i_VmIMw/TnVJNQ8kw6I/AAAAAAAAArs/e-Xfj9LkD5o/s1600/example-chinese-comb.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-WOD5i_VmIMw/TnVJNQ8kw6I/AAAAAAAAArs/e-Xfj9LkD5o/s1600/example-chinese-comb.png" /></a></div>By finding the shortest paths between pairs of odd nodes (red), we can make this mini-graph Eulerian - i.e. so all nodes have even degree. This means we can find the optimal tour around the graph (right). In this case we have to travel an additional 12 units.<br /><br />Of course, it gets more complicated when you're working with the full Pac-Man graph.<br /><br />When there are more than two nodes of odd degree, you also have to find the combination of pairings which minimises the total tour size. For an idea of scale, there are 20 odd nodes in the Pac-Man graph. That means there are 654,729,075 pair combinations to check and compare. And you have to <a href="http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm#Running_time">run</a> Dijkstra's algorithm 10 times for each of those permutations. It adds up.<br /><br /><br />So instead, I took the essence of the algorithm and constructed a route by hand. This is not necessarily the optimal route. For this route, you have to travel an extra 60 units - including 9 units along a path segment that doesn't contain any pellets.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-DJ2OXDyBUgw/TnVLikb70HI/AAAAAAAAArw/rweQT6DqYMg/s1600/pacman-path.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-DJ2OXDyBUgw/TnVLikb70HI/AAAAAAAAArw/rweQT6DqYMg/s1600/pacman-path.png" /></a></div>There are other paths around the maze which cover (and recover) the same  same ground as the above solution, and others that double back over  different ground, but that add up to the same distance. <br /><br />One constraint, in the case of Pac-Man, is that the path has to start at the point near the bottom of the maze, where Pac-Man starts in the game.<br /><br />But also, it doesn't matter where the tour finishes (where as, the Chinese Postman starts and finishes at the same point). This means modifications to the 'optimal' solution may be possible/required.<br /><br />In the bottom-corner example, we can eliminate some of the extra paths (up to 9 units worth) if we don't care where we end up.<br /><br /><br />If I ever get around to programming and running the proper algorithm, I'll let you know what the 'proper' solution is. And if you can find a better solution, let me know.<br /><br /><br />Of course what I haven't taken into account is the fact that, as you're making your way around the maze, you're also trying to avoid ghosts. I'll be honest, this path finding was more of an intellectual exercise than anything practical. You can find some strategic tips <a href="http://strategywiki.org/wiki/Pac-Man/Tips">here</a>.<br /><br /><br /><b>This Maze Ain't Big Enough For the Both of Us.</b><br /><br />If you follow me on Twitter, you may have already read about this - in a dream I formulated a multiplayer version of Pac-Man. But weird, subconscious machinations aside..<br /><br />I looked it up on wikipedia, and there was already a multiplayer Pac-Man - <a href="http://en.wikipedia.org/wiki/Pac-Man_Vs.">Pac-Man Vs.</a> But in that game you have one player playing as Pac-Man, and any additional players as ghosts. The aim is for the Pac-Man player to collect pellets and for ghost players to stop them. My idea is better.<br /><br />First of all, you'd probably need to make the maze bigger. Each player plays as a Pac-Man, and like the normal game, their aim is to collect the most points, while trying to avoid ghosts. The game introduces a new special pellet which lets you cannibalise an opponent Pac-Man (much like the pellet that lets you eat ghosts).<br /><br />Each player starts with two lives. If they lose both their lives they become a ghost. As a ghost, other ghosts can't hurt you, but you can't collect any pellets. If you catch an opponent Pac-Man, you steal one of their lives (becoming a 'living' Pac-Man again, with one life). If an opponent Pac-Man gets one of the special ghost pellets, they can eat a ghost opponent, killing them for good.<br /><br />The game ends when all the pellets are collected or when all players are ghosts/dead. The winner is the player with the most points.<br /><br />Or something like that. <br /><br />If only I have the know how to make a real, playable version. But, hey, if there happens to be anyone out there reading this who could make it, please do..<br /><br /><br />Oatzy.