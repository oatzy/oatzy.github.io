---
layout: post
title: Where are the Carriages?
date: '2012-03-03T16:12:00.000-08:00'
author: Oatzy
tags:
- rant
- rush hour
- trains
- voting
- optimisation
- algorithm
- public transport
- hand-waving
- maths
modified_time: '2012-03-03T16:12:33.357-08:00'
blogger_id: tag:blogger.com,1999:blog-14769935.post-7422877434607215907
blogger_orig_url: https://oatzy.blogspot.com/2012/03/where-are-carriages.html
---

<b>&lt;rant&gt; </b><br /><br />So it's around 9am, and you're waiting for a train. The trains in your area are a bit scummy, but whatever, you can't drive, and you've got to get to work/uni somehow. It's pretty busy, what with it being 9am, and when the train finally pulls up.. it's a single carriage.<br /><br />Now a single car has <a href="http://en.wikipedia.org/wiki/British_Rail_Class_142">around 50 seats</a>, and this train is packed tight, with people standing in the aisles and the doorways, being forced to get intimate. And with everyone on board the conductor can barely get through the door. There are clearly enough people on this train to fill two cars, with people still having to stand.<br /><br />So what gives? You're pretty pissed about having to stand for half an hour, and you've been inadvertently touched by strangers in ways you're not comfortable with. So you get your complaining hat on, and you turn to the internet to unleash the fury.<br /><br />The train company's website directs you to their <a href="https://twitter.com/#%21/northernrailorg">Twitter feed</a>, where a poor public relations person is taking a barrage of vitriol from other angry commuters, while doing their best to remain polite and professional. <br /><br />Several other people have already made your complaint, but all they're getting in return is "<a href="https://twitter.com/#%21/northernrailorg/status/175648061274591232">Apologies we try to avoid this where possible</a>", or that the short trains were "<a href="https://twitter.com/#%21/northernrailorg/status/174544893220360193">due to operational reasons</a>". And that's not really a satisfying response. You're not even sure it means anything.<br /><br />&lt;/rant&gt;<br /><br /><br /><b>So Where Are The Carriages?</b><br /><br /><i>Disclaimer</i>: I have no idea how the train company actually operates. I just like to write blogs about applied maths.<br /><br />Here's the setup - you're in charge of logistics for the train company. You have a fixed number of trains/cars, and, for each day, a list of services and expected numbers of passengers.<br /><br />How do you apportion the carriages between the services?<br /><br />Obviously, every service needs at least one car, and services with more passengers need more cars.<br /><br />So if you had, for example, three services with 50, 100, and 150 passengers respectively, and 6 cars, then it's easy to divvy them up - one for the first, two for the second, and three for the third.<br /><br />But in general, it won't be possible to divide up the cars exactly like that; so what do you do about remainders?<br /><br />This is actually similar to the problem of apportioning parliamentary seats between states in the US.<br /><br />Currently there are 435 seats in the <a href="http://en.wikipedia.org/wiki/United_States_House_of_Representatives#Apportionment">House of Representatives</a>, which need to be shared out between the 50 states according to each state's population - the idea being that each seat should represent roughly the same number of voters. <br /><br />There are <a href="http://www.ctl.ua.edu/math103/apportionment/quick.htm">various methods</a> for doing this, but I'm only going to go over two of them.<br /><br /><br /><b>The Hamilton method </b><br /><br /><i><a href="http://en.wikipedia.org/wiki/Hamilton_method">Hamilton's Method</a></i> is the easiest and most intuitive.<br /><br />Say you've got only two services - service A has 85 passengers, service B has 115 passengers (200 passengers total). And you happen to have 4 carriages - a total 200 seats. So seats for everyone! Except service A needs 1.7 cars, and service B needs 2.3 cars. And you can't divide a car into two chunks.<br /><br />But for starters, you can give one car to service A (50 seats), and two to service B (100 seats). So what about the fourth? Regardless of which service you give it to, some people are going to end up having to stand. So what you want to do is minimise that number.<br /><br />For service A, 35 people need a seat. For service B, 15 people need a seat. So it makes sense to give the last car to service A. 15 people still have to stand, but - short of building more cars - there's really nothing you can do about that.<br /><br />This is also known as the <a href="http://en.wikipedia.org/wiki/Largest_remainder_method"><i>largest remainder method</i></a>.<br /><br />What if the passenger numbers were 75 and 125? Well in that case, I guess it would have to be a judgement call.<br /><br />Anyway, that's the basic idea of the Hamilton method - divide up the cars as far as you can, then give the remaining car(s) to the service(s) which 'need them most'.<br /><br />Things get trickier when you're dealing with larger numbers of passengers and cars, but ultimately it's pretty straight-forward.<br /><br /><br /><b>The Huntington-Hill Method</b><br /><br />Where trains differ from apportioning of parliamentary  seats, is that a carriage has a fixed capacity, whereas the number of  people a seat can represent is free to change.<br /><br />And this means that you won't encounter some of the '<a href="http://en.wikipedia.org/wiki/Alabama_paradox">quirks</a>' that arise from the Hamilton method - such as the <i>Alabama Paradox</i> (where increasing the total number of seats can mean a state losing seats), or the <i>Population Paradox</i> (where increasing a state's population can result in that state losing seats).<br /><br />[You won't encounter them, but they're worth mentioning 'cause they're pretty cool.] <br /><br /><a href="http://en.wikipedia.org/wiki/Huntington%E2%80%93Hill_method"><i>Huntington-Hill's Method</i></a> - the one currently used by the House of Representatives - is, generally, a more powerful method than Hamilton's, and <a href="http://www.cut-the-knot.org/ctk/Democracy.shtml">isn't susceptible</a> to the various paradoxes. Another benefit is that it can be set up to guarantee that each state will get at least one seat.<br /><br />It works by assigning seats, one by one, based on each state's '<a href="http://en.wikipedia.org/wiki/Highest_averages_method">priority quotient</a>' - itself based on the state's population, and a 'modified divisor' based on the number of seats already allocated to that state.<br /><br />But one advantage Hamilton's Method has over HHM, is that it will always give each service its ideal number of cars, either rounded up of down to the nearest  whole number. So if a service's ideal number is 3.67, then Hamilton's  method will assign either 3 or 4 cars to that service.<br /><br />HHM, on the other hand, can 'violate quota' - that is, it can result in a given service being assigned more or fewer cars than it's ideal number (e.g. the 3.67 service might end up with only 2 cars). But this problem only occurs when the number of cars is fixed prior to apportioning. And sadly, it usually is.<br /><br /><br />As an aside, it turns out it's <a href="http://en.wikipedia.org/wiki/Alabama_paradox#Impossibility_result">impossible</a> to find a 'perfect' method of apportioning - one with neither paradoxes nor quota violating. Incidentally, the <a href="http://en.wikipedia.org/wiki/Category:Voting_theory">mathematical theory</a> surrounding voting is <a href="http://www.newscientist.com/article/mg20627581.400-electoral-dysfunction-why-democracy-is-always-unfair.html">quite fascinating</a>. You know, if you're into that sort of thing.<br /><br /><br /><b>Unfortunately..</b><br /><br />Either method would work perfectly well. The problem is, while rounding up or down to the nearest car may seem trivial, the 50 seats that that one car represents can be a significant gain/loss for a service.<br /><br />The lack of precise information can cause problems as well. You can only estimate how many passengers a given service will have in advance, and if you under-estimate, people are gonna be pretty pissed.<br /><br />And on top of that, the numbers have to be recalculated from time to time as passenger numbers change..<br /><br />Basically, getting the number of cars right can be tricky.<br /><br /><br />Of course, this all assumes that Northern Rail (or whatever company) has enough carriages to adequately satisfy its needs in the first place. Some how I doubt that's the case.<br /><br />So ideally, NR needs to work out how many cars it actually needs, and build them. But I can't see that happening. And even if it did happen, it'd probably mean higher fares. And fares are pretty bad as they are.<br /><br />Really, though, NR could do with a complete makeover just in general, given <a href="http://en.wikipedia.org/wiki/Northern_Rail#Criticism">how</a> <a href="https://twitter.com/#%21/northernfail">shitty</a> it is. Seriously, you should see the difference between them and the London Midland service. Ridiculous.<br /><br />Incidentally, I also have strong feelings about the buses; don't even get me started. Trams are alright though - one every 10mins, seldom short of seats, sufficient leg-room.. bliss.<br /><br /><br /><i><b>tl;dr</b></i> - Where are the carriages, then? As it turns out, it's probably just that they <a href="https://twitter.com/#%21/northernrailorg/status/175558593863622656">don't have enough</a> to go around.<br /><br />This is what we get for <a href="http://en.wikipedia.org/wiki/Privatization_of_British_Rail">privatising</a> the trains... <br /><br /><br />Oatzy.<br /><br /><br />[My complaining hat is a trilby. I like to look bad-ass while I'm complaining.]